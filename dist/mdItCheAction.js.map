{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","../index.js","../lib/index.js","../lib/ruler.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"mdItCheAction.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\n\nmodule.exports = require('./lib/');","'use strict';\n\nvar che_action_ruler = require(\"./ruler\");\n\nmodule.exports = function action_plugin(md, options) {\n\n    //add new \"action\" rule\n    md.renderer.rules.action = function (tokens, idx /*, options, env, self */) {\n        return \"<input type=\\\"button\\\" id=\\\"\" + tokens[idx].meta + \"\\\" value=\\\"Che action\\\">\";\n    };\n\n    md.core.ruler.push('action', che_action_ruler(md))\n};\n","'use strict';\n\nmodule.exports = function che_action_ruler(md) {\n\n  function createTokensToReplace(text, Token) {\n\n    var regexpr = new RegExp(/\\[action, [^\\]]+\\]/gi), //todo improve regexp\n        last_index = 0,\n        nodes = [],\n        token;\n\n    text.replace(regexpr, function (match, offset) {\n      if (offset > last_index) {\n        token = new Token(\"text\", '', 0);\n        token.content = text.slice(last_index, offset);\n        nodes.push(token);\n      }\n\n      token = new Token('action', '', 0);\n      token.content = \"\";\n      token.meta = \"id!\";\n      nodes.push(token);\n\n      last_index = offset + match.length;\n    });\n\n    if (last_index < text.length) {\n      token = new Token('text', '', 0);\n      token.content = text.slice(last_index);\n      nodes.push(token);\n    }\n\n    return nodes;\n  }\n\n  return function(state) {\n    var i,\n        j,\n        tokens,\n        blockTokens = state.tokens;\n\n    for (j = 0; j < blockTokens.length; j++) {\n      if (blockTokens[j].type !== 'inline') {\n        continue;\n      }\n      tokens = blockTokens[j].children;\n\n      for (i = tokens.length - 1; i >= 0; i--) {\n        var token = tokens[i];\n\n        var regExp = new RegExp(\".*\\\\[action,.*\\\\].*\"); //todo improve regexp\n        if (token.type === 'text' && regExp.test(token.content)) {\n          var newToken = createTokensToReplace(token.content, state.Token);\n          blockTokens[j].children = tokens = md.utils.arrayReplaceAt(tokens, i, newToken);\n        }\n      }\n    }\n  }\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIuLi9pbmRleC5qcyIsIi4uL2xpYi9pbmRleC5qcyIsIi4uL2xpYi9ydWxlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIndXNlIHN0cmljdCc7XG5cblxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2xpYi8nKTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBjaGVfYWN0aW9uX3J1bGVyID0gcmVxdWlyZShcIi4vcnVsZXJcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gYWN0aW9uX3BsdWdpbihtZCwgb3B0aW9ucykge1xuXG4gICAgLy9hZGQgbmV3IFwiYWN0aW9uXCIgcnVsZVxuICAgIG1kLnJlbmRlcmVyLnJ1bGVzLmFjdGlvbiA9IGZ1bmN0aW9uICh0b2tlbnMsIGlkeCAvKiwgb3B0aW9ucywgZW52LCBzZWxmICovKSB7XG4gICAgICAgIHJldHVybiBcIjxpbnB1dCB0eXBlPVxcXCJidXR0b25cXFwiIGlkPVxcXCJcIiArIHRva2Vuc1tpZHhdLm1ldGEgKyBcIlxcXCIgdmFsdWU9XFxcIkNoZSBhY3Rpb25cXFwiPlwiO1xuICAgIH07XG5cbiAgICBtZC5jb3JlLnJ1bGVyLnB1c2goJ2FjdGlvbicsIGNoZV9hY3Rpb25fcnVsZXIobWQpKVxufTtcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjaGVfYWN0aW9uX3J1bGVyKG1kKSB7XG5cbiAgZnVuY3Rpb24gY3JlYXRlVG9rZW5zVG9SZXBsYWNlKHRleHQsIFRva2VuKSB7XG5cbiAgICB2YXIgcmVnZXhwciA9IG5ldyBSZWdFeHAoL1xcW2FjdGlvbiwgW15cXF1dK1xcXS9naSksIC8vdG9kbyBpbXByb3ZlIHJlZ2V4cFxuICAgICAgICBsYXN0X2luZGV4ID0gMCxcbiAgICAgICAgbm9kZXMgPSBbXSxcbiAgICAgICAgdG9rZW47XG5cbiAgICB0ZXh0LnJlcGxhY2UocmVnZXhwciwgZnVuY3Rpb24gKG1hdGNoLCBvZmZzZXQpIHtcbiAgICAgIGlmIChvZmZzZXQgPiBsYXN0X2luZGV4KSB7XG4gICAgICAgIHRva2VuID0gbmV3IFRva2VuKFwidGV4dFwiLCAnJywgMCk7XG4gICAgICAgIHRva2VuLmNvbnRlbnQgPSB0ZXh0LnNsaWNlKGxhc3RfaW5kZXgsIG9mZnNldCk7XG4gICAgICAgIG5vZGVzLnB1c2godG9rZW4pO1xuICAgICAgfVxuXG4gICAgICB0b2tlbiA9IG5ldyBUb2tlbignYWN0aW9uJywgJycsIDApO1xuICAgICAgdG9rZW4uY29udGVudCA9IFwiXCI7XG4gICAgICB0b2tlbi5tZXRhID0gXCJpZCFcIjtcbiAgICAgIG5vZGVzLnB1c2godG9rZW4pO1xuXG4gICAgICBsYXN0X2luZGV4ID0gb2Zmc2V0ICsgbWF0Y2gubGVuZ3RoO1xuICAgIH0pO1xuXG4gICAgaWYgKGxhc3RfaW5kZXggPCB0ZXh0Lmxlbmd0aCkge1xuICAgICAgdG9rZW4gPSBuZXcgVG9rZW4oJ3RleHQnLCAnJywgMCk7XG4gICAgICB0b2tlbi5jb250ZW50ID0gdGV4dC5zbGljZShsYXN0X2luZGV4KTtcbiAgICAgIG5vZGVzLnB1c2godG9rZW4pO1xuICAgIH1cblxuICAgIHJldHVybiBub2RlcztcbiAgfVxuXG4gIHJldHVybiBmdW5jdGlvbihzdGF0ZSkge1xuICAgIHZhciBpLFxuICAgICAgICBqLFxuICAgICAgICB0b2tlbnMsXG4gICAgICAgIGJsb2NrVG9rZW5zID0gc3RhdGUudG9rZW5zO1xuXG4gICAgZm9yIChqID0gMDsgaiA8IGJsb2NrVG9rZW5zLmxlbmd0aDsgaisrKSB7XG4gICAgICBpZiAoYmxvY2tUb2tlbnNbal0udHlwZSAhPT0gJ2lubGluZScpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICB0b2tlbnMgPSBibG9ja1Rva2Vuc1tqXS5jaGlsZHJlbjtcblxuICAgICAgZm9yIChpID0gdG9rZW5zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIHZhciB0b2tlbiA9IHRva2Vuc1tpXTtcblxuICAgICAgICB2YXIgcmVnRXhwID0gbmV3IFJlZ0V4cChcIi4qXFxcXFthY3Rpb24sLipcXFxcXS4qXCIpOyAvL3RvZG8gaW1wcm92ZSByZWdleHBcbiAgICAgICAgaWYgKHRva2VuLnR5cGUgPT09ICd0ZXh0JyAmJiByZWdFeHAudGVzdCh0b2tlbi5jb250ZW50KSkge1xuICAgICAgICAgIHZhciBuZXdUb2tlbiA9IGNyZWF0ZVRva2Vuc1RvUmVwbGFjZSh0b2tlbi5jb250ZW50LCBzdGF0ZS5Ub2tlbik7XG4gICAgICAgICAgYmxvY2tUb2tlbnNbal0uY2hpbGRyZW4gPSB0b2tlbnMgPSBtZC51dGlscy5hcnJheVJlcGxhY2VBdCh0b2tlbnMsIGksIG5ld1Rva2VuKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufSJdfQ=="}